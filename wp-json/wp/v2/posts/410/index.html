{"id":410,"date":"2023-08-03T07:00:04","date_gmt":"2023-08-03T07:00:04","guid":{"rendered":"http:\/\/192.168.0.142\/?p=410"},"modified":"2023-08-03T07:06:47","modified_gmt":"2023-08-03T07:06:47","slug":"finalize-and-dispose-in-c","status":"publish","type":"post","link":"http:\/\/192.168.0.142\/finalize-and-dispose-in-c\/","title":{"rendered":"Finalize and Dispose in C#"},"content":{"rendered":"\n<ul>\n<li>They are used to clean up unmanaged resources.<\/li>\n\n\n\n<li> Class instances often encapsulate control over resources that are not managed by the run time, such as windows handles (HWND), database connections and so on. Therefore we should provide both an explicit and implicit way to free those resources.<\/li>\n\n\n\n<li>We can provide implicit control by implementing the protected Finalize on an object (destructor). The garbage collector calls this method at some point after there are no longer any valid references to the object.<\/li>\n\n\n\n<li>In some cases, we might want to provide programmers using an object with the ability to explicitly release these external resources before the garbage collector frees the object. If and external resource is scarce or expensive, better performance can be achieved if the programmer explicitly releases resources when they are no longer being used. To provide explicit control, implement the Dispose provided by IDisposable. The consumer of the object should call this method when it is finished using the object. Dispose can be called even if other references to the object are alive.<\/li>\n\n\n\n<li>Even when you provide explicit control using Dispose, you should provide implicit clean up using the Finalize method. Finalize provides a back up to prevent resources from permanently leaking if the programmer fails to call Dispose.<\/li>\n<\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code lang=\"csharp\" class=\"language-csharp\">\/\/ Design pattern for a base class.\npublic class Base: IDisposable\n{\n    private bool disposed = false;\n    \/\/Implement IDisposable.\n    public void Dispose()\n    {\n        Dispose(true);\n        GC.SuppressFinalize(this);\n    }\n\n    protected virtual void Dispose(bool disposing)\n    {\n        if (!disposed)\n        {\n            if (disposing)\n            {\n                \/\/ Free other state (managed objects).\n            }\n            \/\/ Free your own state (unmanaged objects).\n            \/\/ Set large fields to null.\n            disposed = true;\n        }\n    }\n\n    \/\/ Use C# destructor syntax for finalization code.\n    ~Base()\n    {\n        \/\/ Simply call Dispose(false).\n        Dispose (false);\n    }\n}\n<\/code><\/pre>\n\n\n\n<pre class=\"wp-block-code\"><code lang=\"csharp\" class=\"language-csharp\">\/\/ Design pattern for a derived class.\npublic class Derived: Base\n{\n    private bool disposed = false;\n    protected override void Dispose(bool disposing)\n    {\n        if (!disposed)\n        {\n            if (disposing)\n            {\n                \/\/ Release managed resources.\n            }\n            \/\/ Release unmanaged resources.\n            \/\/ Set large fields to null.\n           \/\/ Call Dispose on your base class.\n            disposed = true;\n        }\n        base.Dispose(disposing);\n    }\n    \/\/ The derived class does not have a Finalize method\n    \/\/ or a Dispose method without parameters because it inherits\n    \/\/ them from the base class.\n}\n<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-table\"><table><thead><tr><th><strong>Dispose<\/strong><\/th><th><strong>Finalize<\/strong><\/th><\/tr><\/thead><tbody><tr><td>It is used to free unmanaged resources like files, database connections etc. at any time.<\/td><td>It can be used to free unmanaged resources (when you implement it) like files, database connections etc. held by an object before that object is destroyed.<\/td><\/tr><tr><td>Explicitly, it is called by user code and the class which is implementing dispose method, must has to implement IDisposable interface.<\/td><td>Internally, it is called by Garbage Collector and cannot be called by user code.<\/td><\/tr><tr><td>It belongs to IDisposable interface.<\/td><td>It belongs to Object class<\/td><\/tr><tr><td>It&#8217;s implemented by implementing IDisposable interface Dispose() method.<\/td><td>It&#8217;s implemented with the help of destructor in C++ &amp; C#.<\/td><\/tr><tr><td>There is no performance costs associated with Dispose method.<\/td><td>There is performance costs associated with Finalize method since it doesn&#8217;t clean the memory immediately and called by GC automatically<\/td><\/tr><\/tbody><\/table><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Dispose Finalize It is used to free unmanaged resources like files, database connections etc. at any time. It can be used to free unmanaged resources (when you implement it) like files, database connections etc. held by an object before that object is destroyed. Explicitly, it is called by user code and the class which is &#8230; <a title=\"Finalize and Dispose in C#\" class=\"read-more\" href=\"http:\/\/192.168.0.142\/finalize-and-dispose-in-c\/\" aria-label=\"More on Finalize and Dispose in C#\">Read more<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[32],"tags":[33],"_links":{"self":[{"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/posts\/410"}],"collection":[{"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/comments?post=410"}],"version-history":[{"count":6,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/posts\/410\/revisions"}],"predecessor-version":[{"id":419,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/posts\/410\/revisions\/419"}],"wp:attachment":[{"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/media?parent=410"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/categories?post=410"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/192.168.0.142\/wp-json\/wp\/v2\/tags?post=410"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}